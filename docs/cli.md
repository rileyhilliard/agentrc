# CLI reference

All commands run from your project root (the directory containing `.agentrc/`).

## init

Create a new `.agentrc/` directory with starter files.

```bash
agentrc init [--template <name>]
```

| Option | Description |
|--------|-------------|
| `-t, --template <name>` | Starter template to use. Only `default` is currently supported. |

Creates:
- `.agentrc/config.yaml` with `version: "1"` and `claude` + `cursor` as default targets
- `.agentrc/rules/general.md` with a placeholder always-on rule

If `.agentrc/` already exists, the command prints a warning and exits without changes.

## build

Generate platform-native config files from `.agentrc/`.

```bash
agentrc build [--targets <platforms>] [--dry-run]
```

| Option | Description |
|--------|-------------|
| `-t, --targets <platforms>` | Comma-separated list of platforms. Overrides `targets` in config.yaml. |
| `--dry-run` | Preview what files would be generated without writing anything. |

**What it does:**

1. Loads and validates `.agentrc/` (config, rules, commands, skills, agents)
2. Builds an intermediate representation (IR) from all sources
3. Runs each target's adapter to produce platform-native output
4. Writes files to disk, adding generated-file headers
5. Updates `.gitignore` with a managed block so generated files aren't committed

**Examples:**

```bash
# Build for targets defined in config.yaml
agentrc build

# Build only for Claude and Cursor
agentrc build --targets claude,cursor

# Preview without writing
agentrc build --dry-run
```

Each target reports which features are native and which are degraded:

```
claude:
  ✓ instructions
  ✓ scoped-rules
  ✓ hooks
  ✓ commands
  ✓ skills

cursor:
  ✓ instructions
  ✓ scoped-rules
  ⚠ hooks (folded into behavioral instructions rule)
  ⚠ commands (folded into description-triggered rule)
  ✓ skills
```

## validate

Check `.agentrc/` for errors without generating output.

```bash
agentrc validate
```

No options. Loads config.yaml, parses all rules, commands, skills, and agents, then reports a summary:

```
✓ Config is valid

  Rules:    4
  Hooks:    2
  Commands: 2
  Skills:   1
  Agents:   1
  Targets:  claude, cursor, copilot
```

Warnings are shown for rules with no scope (no `alwaysApply`, `globs`, or `description`) and for missing targets.

## inspect

Preview what a specific platform would receive, without writing files.

```bash
agentrc inspect <platform>
```

| Argument | Description |
|----------|-------------|
| `platform` | The target platform name (e.g., `claude`, `cursor`, `copilot`) |

Shows native features, degraded features, output files with line counts, and any warnings.

**Example:**

```bash
agentrc inspect windsurf
```

```
Inspecting output for: windsurf

Native features:
  ✓ instructions
  ✓ scoped-rules

Degraded features:
  ⚠ hooks (folded into conventions file)
  ⚠ commands (folded into conventions file)
  ⚠ skills (folded into conventions file)

Files:
  .windsurf/rules/typescript-strict.md (8 lines)
  .windsurf/rules/react-components.md (10 lines)
  .windsurf/rules/code-style.md (6 lines)
  .windsurf/rules/agentrc-conventions.md (24 lines)
```

## clean

Remove all files generated by agentrc.

```bash
agentrc clean
```

No options. Uses the manifest file (`.agentrc/.manifest.json`) to track which files were generated, then deletes them. Also removes the agentrc managed block from `.gitignore`.

If no manifest is found, the command reports nothing to clean.

## migrate

Import existing platform config into `.agentrc/`.

```bash
agentrc migrate
```

No options. Scans for existing configuration files and imports them as rules:

| Source | Imported as |
|--------|-------------|
| `CLAUDE.md` | `.agentrc/rules/claude-imported.md` (alwaysApply, priority: normal) |
| `.cursor/rules/*.md` | `.agentrc/rules/cursor-{name}.md` (preserves existing frontmatter) |
| `.clinerules/*.md` | `.agentrc/rules/cline-{name}.md` (translates `paths:` to `globs:`) |

Migration is additive. If `.agentrc/` already exists, imported rules are added alongside existing ones. A minimal `config.yaml` is created if one doesn't exist.

After importing, review the files and run `agentrc build` to generate platform configs.

## Global behavior

- All commands use the current working directory to find `.agentrc/`.
- Exit code `0` on success, `1` on error.
- Errors print to stderr and include the error message.
